# ğŸ—ï¸ Architecture Diagram: 3D Impact Analysis System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE LAYER                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  â”‚  â”‚                     â”‚  â”‚                            â”‚ â”‚
â”‚  â”‚  Custom Object   â”‚  â”‚   3D Solar System   â”‚  â”‚  Impact Analysis Modal     â”‚ â”‚
â”‚  â”‚  Manager         â”‚  â”‚   View (Three.js)   â”‚  â”‚  (Enhanced)                â”‚ â”‚
â”‚  â”‚                  â”‚  â”‚                     â”‚  â”‚                            â”‚ â”‚
â”‚  â”‚  - Add/Remove    â”‚  â”‚  - Render planets   â”‚  â”‚  - Overview Tab            â”‚ â”‚
â”‚  â”‚  - Presets       â”‚  â”‚  - Custom objects   â”‚  â”‚  - Crater Tab              â”‚ â”‚
â”‚  â”‚  - NASA API      â”‚  â”‚  - Crater zones     â”‚  â”‚  - Damage Tab              â”‚ â”‚
â”‚  â”‚  - Form inputs   â”‚  â”‚  - Impact markers   â”‚  â”‚  - Comparison Tab          â”‚ â”‚
â”‚  â”‚                  â”‚  â”‚  - Click detection  â”‚  â”‚                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                       â”‚                            â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚                            â”‚
            â”‚  onAddObject()        â”‚  onImpactAnalysis()        â”‚  Display
            â”‚  onRemoveObject()     â”‚  onObjectClick()           â”‚  analysis
            â”‚                       â”‚                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         STATE MANAGEMENT LAYER                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                   â”‚
â”‚  React State (app/impact-analysis-3d/page.tsx)                                   â”‚
â”‚                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  customObjects: CelestialBody[]    // Array of asteroids/comets         â”‚    â”‚
â”‚  â”‚  simulationTime: number            // Seconds elapsed                   â”‚    â”‚
â”‚  â”‚  isPaused: boolean                 // Playback state                    â”‚    â”‚
â”‚  â”‚  simulationSpeed: number           // 1x to 1M x real-time              â”‚    â”‚
â”‚  â”‚  selectedObject: CelestialBody     // Currently analyzed object         â”‚    â”‚
â”‚  â”‚  impactAnalysis: ImpactAnalysis    // Analysis results                  â”‚    â”‚
â”‚  â”‚  showAnalysisModal: boolean        // Modal visibility                  â”‚    â”‚
â”‚  â”‚  focusPlanet: string               // Camera focus target               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                   â”‚
â”‚  useEffect(() => {                     // Simulation loop (60 FPS)               â”‚
â”‚    setSimulationTime(prev => prev + speed / 60)                                  â”‚
â”‚  }, [isPaused, speed])                                                           â”‚
â”‚                                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚  Uses
                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PHYSICS/CALCULATION LAYER                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                   â”‚
â”‚  lib/orbital-mechanics.ts                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  solveKeplerEquation(M, e)        â†’ E (eccentric anomaly)               â”‚    â”‚
â”‚  â”‚  calculateTrueAnomaly(E, e)       â†’ Î½ (true anomaly)                    â”‚    â”‚
â”‚  â”‚  calculateOrbitalPosition(elem, t) â†’ {x, y, z} in 3D space              â”‚    â”‚
â”‚  â”‚  calculateImpactProbability(obj)  â†’ ImpactAnalysis {                    â”‚    â”‚
â”‚  â”‚    - closestApproach                                                     â”‚    â”‚
â”‚  â”‚    - impactProbability                                                   â”‚    â”‚
â”‚  â”‚    - riskLevel                                                           â”‚    â”‚
â”‚  â”‚    - kineticEnergy                                                       â”‚    â”‚
â”‚  â”‚  }                                                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                   â”‚
â”‚  lib/impact-calculator.ts                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  calculateImpact(asteroid)        â†’ ImpactResults {                     â”‚    â”‚
â”‚  â”‚    - energy (Joules, megatons)                                          â”‚    â”‚
â”‚  â”‚    - crater (diameter, depth)                                           â”‚    â”‚
â”‚  â”‚    - damage (airblast, thermal, seismic)                                â”‚    â”‚
â”‚  â”‚    - comparison (historical events)                                     â”‚    â”‚
â”‚  â”‚    - severity (minor â†’ extinction)                                      â”‚    â”‚
â”‚  â”‚  }                                                                       â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚  Formulas:                                                               â”‚    â”‚
â”‚  â”‚  â€¢ E = Â½mvÂ²                       (Kinetic energy)                      â”‚    â”‚
â”‚  â”‚  â€¢ D = 0.07 Ã— E^0.33              (Crater diameter)                     â”‚    â”‚
â”‚  â”‚  â€¢ R_blast = 2.2 Ã— E^0.33         (Airblast radius)                     â”‚    â”‚
â”‚  â”‚  â€¢ M = 0.67 Ã— logâ‚â‚€(E) + 3.87    (Seismic magnitude)                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚  Powers
                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         3D RENDERING LAYER (Three.js)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                   â”‚
â”‚  components/solar-system-3d-view.tsx                                             â”‚
â”‚                                                                                   â”‚
â”‚  Scene Setup:                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  THREE.Scene()                    // 3D world container                 â”‚    â”‚
â”‚  â”‚  THREE.PerspectiveCamera()        // Viewer perspective                 â”‚    â”‚
â”‚  â”‚  THREE.WebGLRenderer()            // GPU rendering                      â”‚    â”‚
â”‚  â”‚  OrbitControls()                  // Mouse/touch controls               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                   â”‚
â”‚  Objects:                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Sun                              // THREE.SphereGeometry(5)            â”‚    â”‚
â”‚  â”‚    â””â”€ 8K texture                  // Realistic solar surface            â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚  Planets [8]                      // Mercury â†’ Neptune                  â”‚    â”‚
â”‚  â”‚    â”œâ”€ Sphere meshes               // Textured (2k-8k)                   â”‚    â”‚
â”‚  â”‚    â”œâ”€ Orbit paths                 // Elliptical lines                   â”‚    â”‚
â”‚  â”‚    â””â”€ Rotation                    // Real rotation speeds               â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚  Custom Objects [dynamic]         // Asteroids/comets/etc               â”‚    â”‚
â”‚  â”‚    â”œâ”€ Sphere meshes               // Color-coded by type                â”‚    â”‚
â”‚  â”‚    â”œâ”€ Orbit paths                 // Elliptical (Kepler)                â”‚    â”‚
â”‚  â”‚    â””â”€ Click detection             // Raycaster                          â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚  Impact Visualization             // Created on click                   â”‚    â”‚
â”‚  â”‚    â”œâ”€ Shockwave sphere (red)      // Transparent, large                 â”‚    â”‚
â”‚  â”‚    â”œâ”€ Ejecta sphere (orange)      // Semi-transparent                   â”‚    â”‚
â”‚  â”‚    â”œâ”€ Rim sphere (brown)          // Solid                              â”‚    â”‚
â”‚  â”‚    â”œâ”€ Impact marker (red)         // Pulsing animation                  â”‚    â”‚
â”‚  â”‚    â””â”€ Distance line (yellow)      // Earth â†” Object                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                   â”‚
â”‚  Animation Loop (60 FPS):                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  requestAnimationFrame(() => {                                          â”‚    â”‚
â”‚  â”‚    // Update planetary positions (Kepler)                               â”‚    â”‚
â”‚  â”‚    planets.forEach(p => {                                               â”‚    â”‚
â”‚  â”‚      const pos = calculateOrbitalPosition(p.elements, simTime)          â”‚    â”‚
â”‚  â”‚      p.mesh.position.set(pos.x, pos.y, pos.z)                           â”‚    â”‚
â”‚  â”‚    })                                                                    â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚    // Update custom objects                                             â”‚    â”‚
â”‚  â”‚    customObjects.forEach(obj => {                                       â”‚    â”‚
â”‚  â”‚      const pos = calculateOrbitalPosition(obj.elements, simTime)        â”‚    â”‚
â”‚  â”‚      obj.mesh.position.set(pos.x, pos.y, pos.z)                         â”‚    â”‚
â”‚  â”‚    })                                                                    â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚    // Update crater visualizations                                      â”‚    â”‚
â”‚  â”‚    impactViz.forEach(viz => {                                           â”‚    â”‚
â”‚  â”‚      viz.marker.scale.set(1 + sin(time) * 0.3, ...)  // Pulse          â”‚    â”‚
â”‚  â”‚      viz.line.setFromPoints([earthPos, objPos])      // Track           â”‚    â”‚
â”‚  â”‚    })                                                                    â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚    renderer.render(scene, camera)                                       â”‚    â”‚
â”‚  â”‚  })                                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                   â”‚
â”‚  Crater Creation:                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  createCraterVisualization(earth, lat, lon, craterData) {               â”‚    â”‚
â”‚  â”‚    // 1. Convert lat/lon to 3D coordinates                              â”‚    â”‚
â”‚  â”‚    const x = R Ã— cos(lat) Ã— cos(lon)                                    â”‚    â”‚
â”‚  â”‚    const y = R Ã— sin(lat)                                               â”‚    â”‚
â”‚  â”‚    const z = R Ã— cos(lat) Ã— sin(lon)                                    â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚    // 2. Create zone spheres                                            â”‚    â”‚
â”‚  â”‚    const shockwave = new THREE.Mesh(                                    â”‚    â”‚
â”‚  â”‚      new THREE.SphereGeometry(radius * 5),                              â”‚    â”‚
â”‚  â”‚      new THREE.MeshBasicMaterial({color: 0xff0000, opacity: 0.15})      â”‚    â”‚
â”‚  â”‚    )                                                                     â”‚    â”‚
â”‚  â”‚    shockwave.position.set(x, y, z)                                      â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚    // 3. Add to scene                                                   â”‚    â”‚
â”‚  â”‚    scene.add(shockwave, ejecta, rim, marker)                            â”‚    â”‚
â”‚  â”‚                                                                          â”‚    â”‚
â”‚  â”‚    return craterGroup                                                   â”‚    â”‚
â”‚  â”‚  }                                                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA FLOW DIAGRAM                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Input                    State Update                    3D Rendering
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                                                              
Add Object  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ customObjects.push(obj) â”€â”€â”€â”€â”€â”€â–¶ Create mesh
    â”‚                               â”‚                           + orbit path
    â”‚                               â”‚                               â”‚
    â”‚                               â–¼                               â”‚
    â”‚                         Calculate period                      â”‚
    â”‚                         Calculate velocity                    â”‚
    â”‚                               â”‚                               â”‚
    â”‚                               â–¼                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Update state â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                                                    â”‚
Click Object â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Raycaster
    â”‚                                                                   â”‚
    â”‚                                                                   â–¼
    â”‚                                                             Find clicked mesh
    â”‚                                                                   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                   â”‚
    â”‚                              Physics Calculation                 â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                   â”‚
    â””â”€â”€â–¶ calculateImpactProbability() â”€â”€â–¶ Find min distance            â”‚
            â”‚                                   â”‚                       â”‚
            â–¼                                   â–¼                       â”‚
        Loop 360Â° on orbit               Calculate probability         â”‚
            â”‚                                   â”‚                       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
                                                â”‚                       â”‚
                                                â–¼                       â”‚
                                         Risk assessment               â”‚
                                                â”‚                       â”‚
                                                â–¼                       â”‚
                                         Calculate energy              â”‚
                                         Calculate crater              â”‚
                                                â”‚                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
    â”‚                                                                   â”‚
    â””â”€â”€â–¶ createCraterVisualization() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚                                                           â”‚
            â–¼                                                           â”‚
        Create spheres                                                 â”‚
        Position on Earth                                              â”‚
        Add to scene â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
        Animate pulsing
            â”‚
            â–¼
        Update line positions


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         COLOR CODING SCHEME                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Object Types (Orbits):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŸ  Orange (#ff6600)    â†’ Asteroids
ğŸ”µ Cyan (#00ccff)      â†’ Comets
ğŸŸ¡ Yellow (#ffaa44)    â†’ Dwarf Planets
ğŸŸ£ Purple (#9966ff)    â†’ Trans-Neptunian Objects

Crater Zones:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”´ Red (opacity 15%)   â†’ Shockwave zone (outermost)
ğŸŸ  Orange (opacity 30%)â†’ Ejecta blanket
ğŸŸ¤ Brown (opacity 50%) â†’ Crater rim
ğŸ”´ Red (solid)         â†’ Impact marker (pulsing)
ğŸŸ¡ Yellow              â†’ Distance line

Risk Levels:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŸ¢ Green               â†’ None / Very Low
ğŸ”µ Blue                â†’ Low
ğŸŸ¡ Yellow              â†’ Moderate
ğŸŸ  Orange              â†’ High
ğŸ”´ Red                 â†’ Extreme


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PERFORMANCE METRICS                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Rendering:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Target FPS:        60
â€¢ Actual FPS:        55-60 (with 10 objects + craters)
â€¢ Draw calls:        ~50 (optimized with instancing)
â€¢ Triangles:         ~100,000 (high-quality textures)

Calculations:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Kepler solve:      <1ms per object
â€¢ Impact analysis:   ~10ms (360 samples)
â€¢ Crater creation:   <5ms
â€¢ Total frame time:  ~16ms (60 FPS)

Memory:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Textures:          ~150MB (8K Earth, 8K Sun)
â€¢ Geometries:        ~20MB (high-poly spheres)
â€¢ Total GPU:         ~200MB
â€¢ Recommended RAM:   4GB+


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FILE DEPENDENCIES                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

app/impact-analysis-3d/page.tsx
    â”œâ”€â”€ components/solar-system-3d-view.tsx
    â”‚   â”œâ”€â”€ three (npm package)
    â”‚   â”œâ”€â”€ gsap (npm package)
    â”‚   â”œâ”€â”€ lib/orbital-mechanics.ts
    â”‚   â”‚   â””â”€â”€ calculateOrbitalPosition()
    â”‚   â”‚   â””â”€â”€ calculateImpactProbability()
    â”‚   â”‚   â””â”€â”€ solveKeplerEquation()
    â”‚   â””â”€â”€ lib/impact-calculator.ts
    â”‚       â””â”€â”€ calculateImpact()
    â”‚
    â”œâ”€â”€ components/custom-object-manager.tsx
    â”‚   â”œâ”€â”€ components/ui/card.tsx
    â”‚   â”œâ”€â”€ components/ui/button.tsx
    â”‚   â”œâ”€â”€ components/ui/slider.tsx
    â”‚   â”œâ”€â”€ components/ui/select.tsx
    â”‚   â””â”€â”€ lib/nasa-horizons-api.ts (optional)
    â”‚
    â””â”€â”€ components/impact-analysis-modal-enhanced.tsx
        â”œâ”€â”€ components/ui/card.tsx
        â”œâ”€â”€ components/ui/badge.tsx
        â”œâ”€â”€ components/ui/tabs.tsx
        â””â”€â”€ lucide-react (icons)
```

**Legend:**
- `â”€â”€â”€â–¶` = Data flow
- `â””â”€â”€` = Component hierarchy
- `â—€â”€â”€â”€` = Callback/return
- `â”â”â”â”` = Section separator
